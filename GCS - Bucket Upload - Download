#pip install --upgrade google-cloud-storage
import os
from google.cloud import storage
from datetime import datetime,timedelta

try:
    # Initialize a storage client,Setting credentials using the downloaded JSON file
    client = storage.Client.from_service_account_json(json_credentials_path='D:\\Keys\\clgx-etl-data-dev-bietl-sa-1.json')

    #Here we point the current bucket
    bucket = client.bucket("clgx-etl-data-dev-taxbi-looker")   
    print(bucket)   
    folder_names = ["Daily", "Monthly", "Weekly"]
    for folder_name in folder_names:
        blob = bucket.blob(f"{folder_name}/")  # The trailing slash indicates a folder
        blob.upload_from_string('')  # Upload an empty string to create the folder
        print(f"Folder '{folder_name}' created.")



except Exception as e:
    print(f"generated exception is {str(e)}")


# # # To upload a file to the bucket
# # blob = bucket.blob('destination-file-name')
# # blob.upload_from_filename('path-to-your-local-file')

'''
    #uploading to gcp bucket
    blob = bucket.blob("Portfolio/file_subscriptions/Weekly/"+"sample.txt")
    blob.upload_from_filename("E:\\Infa_shared\\Portfolio\\gcp_sample_codes_manoj\\sample.txt")
    
    #Downloading Files from BUCKET 
    list = bucket.list_blobs(prefix="Portfolio/file_subscriptions/Weekly/")
    filter_date = datetime.now().date() - timedelta(days=0)
    filtered_blobs = [blob for blob in list if blob.time_created.date() >= filter_date]
    blob = bucket.blob("Portfolio/file_subscriptions/Weekly/"+"sample.py")
    blob.download_to_filename('E:\\Infa_shared\\Portfolio\\gcp_sample_codes_manoj\\gcp_connecting_with_gsutil\\'+"sample.py")
    for blob in filtered_blobs:
        l1=blob.name.split("/")
        print(f"Name: {l1[-1]}, Created: {blob.time_created.date()}")
        if "sample" in l1[-1]:
            blob = bucket.blob("Portfolio/file_subscriptions/Weekly/"+l1[-1])
            blob.download_to_filename('E:\\Infa_shared\\Portfolio\\gcp_sample_codes_manoj\\gcp_connecting_with_gsutil\\'+l1[-1])
'''
